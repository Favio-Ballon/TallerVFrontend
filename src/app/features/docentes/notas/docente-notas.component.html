<div class="bg-white/90 p-6 rounded-2xl border border-white/30 shadow-md">
  <h2 class="text-lg font-semibold mb-4">Notas por matriculación</h2>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
    <div>
      <label class="block text-sm font-medium mb-1">Curso (Semestre - Materia)</label>
      <select class="w-full px-3 py-2 rounded-md border" (change)="onCourseSelect($any($event.target).value)">
        <option value="">-- seleccionar curso --</option>
        <option *ngFor="let s of semestreMaterias" [value]="s.id">{{ s.materia.nombre }} — {{ s.semestre.nombre }} ({{ s.docente.nombre }} {{ s.docente.apellido }})</option>
      </select>
    </div>
  </div>

  <div class="mb-4" *ngIf="evaluaciones && evaluaciones.length > 0">
    <label class="block text-sm font-medium mb-1">Evaluación</label>
    <select class="w-64 px-3 py-2 rounded-md border" (change)="onEvaluacionSelect($any($event.target).value)">
      <option value="">-- todas --</option>
      <option *ngFor="let ev of evaluaciones" [value]="ev">{{ ev }}</option>
    </select>
  </div>

  <div *ngIf="displayedRows && displayedRows.length > 0">
    <div class="overflow-auto">
      <table class="w-full text-sm">
        <thead>
          <tr class="text-left text-gray-600">
            <th class="py-2">Matriculación</th>
            <th>Alumno</th>
            <th>Evaluación</th>
            <th>Ponderación</th>
            <th>Calificación</th>
            <th>Acción</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of displayedRows" class="border-t">
            <td class="py-2">#{{ r.matriculacionId }}</td>
            <td>{{ r.alumnoNombre }}</td>
            <td>{{ r.evaluacion }}</td>
            <td>{{ r.ponderacion }}%</td>
            <td>{{ r.calificacion }}</td>
            <td class="flex gap-2 items-center">
              <input type="number" class="w-24 px-2 py-1 border rounded" [(ngModel)]="notaToUpload[r.notaId]" min="0" />
              <button class="bg-yellow-500 text-white px-2 py-1 rounded" [disabled]="uploadingNota[r.notaId]" (click)="subirCalificacion(r.notaId)">{{ uploadingNota[r.notaId] ? '...' : 'Subir' }}</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div *ngIf="!notaRows || notaRows.length === 0" class="text-gray-500">No hay notas para el curso seleccionado.</div>
</div>
